OCAMLINCLUDES += +ocamldoc
BYTE_ENABLED = TRUE
OCamlLibrary(odoc_json, odoc_json)

OCAML_LIBS += ../idl/datamodel
OCAMLINCLUDES += ../idl

CAMLP4_FILES = jsapi
UseCamlp4(rpc-light.syntax, $(CAMLP4_FILES))

OCamlProgram(jsapi, jsapi)

.PHONY: doc
doc: jsapi
	mkdir -p api
	./jsapi

.PHONY: sdk-install
sdk-install: doc
	mkdir -p $(SDK)/docs/html
	sh -c 'cp -r -L api $(SDK)/docs/html/'
	cp *.js *.html *.css *.png $(SDK)/docs/html/
	cp citrix/* $(SDK)/docs/html/

.PHONY: clean
clean:
	rm -f *~ *.cmi *.cmx *.cmo *.a *.cma *.cmxa *.run *.opt *.annot *.o
	rm -rf components.js content jsapi
