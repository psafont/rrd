OCamlLibrary(version, version)
OCamlLibrary(sanitycheck, sanitycheck)
OCamlLibrary(stats, stats)
OCamlLibrary(vm_memory_constraints, vm_memory_constraints)
OCamlLibrary(ocamltest, ocamltest)

StaticCLibrary(backtrace_stub, backtrace_stub)
OCamlLibraryClib(backtrace, backtrace, backtrace_stub)

StaticCLibrary(zerocheck_stub, zerocheck_stub)
OCamlLibraryClib(zerocheck, zerocheck, zerocheck_stub)

StaticCLibrary(sigutil_stub, sigutil_stub)
OCamlLibraryClib(sigutil, sigutil, sigutil_stub)

OCamlLibrary(encodings, encodings)

version.ml: version.template
	sed -e "s/@@@HG_ID@@@/$(shell hg id | sed -r 's/(.+)\s.*/\1/g')/" \
	    -e "s/@@@HOSTNAME@@@/$(shell hostname)/" \
	    -e "s/@@@DATE@@@/$(shell date -u +%Y-%m-%d)/" \
	    -e "s/@@@PRODUCT_VERSION@@@/$(PRODUCT_VERSION)/" \
	    -e "s/@@@PRODUCT_BRAND@@@/$(PRODUCT_BRAND)/" \
	    -e "s/@@@BUILD_NUMBER@@@/$(BUILD_NUMBER)/" \
	    < $< > $@

.PHONY: clean
clean:
	rm -f $(CLEAN_OBJS)

.PHONY: install
install:
